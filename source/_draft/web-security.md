---
title: Note | Web Security
date: 2018-10-23
categories: Note
comments: false
tags:
  - Security
---

Web安全技术。

# Chapter 2 Cryptographic Techniques

## 2.2 Symmetric Key Cryptographic Algorithm

对称密钥加密算法，指加密和解密使用相同密钥的加密算法，有时又叫传统密码算法。

广义上从明文生成密文的算法类型有两种：**块加密(block cipher)**、**流加密(stream cipher)**。

块加密将明文$M$分割成$M_1$、$M_2$...$M_n$区段，每一个区段的长度为b，应用相同的演算法则和钥匙，数学表示为$E(M,K)=E(M_1,K)E(M_2,K)...E(M_n,K)$。加密速度慢，但相对较安全。

流加密不将明文切分为区段，而是一次加密资料流的一个位元或一个位元组。常见的做法是将较短的加密钥匙延展成为无限长、近似乱码的一长串**密钥串流(key-stream)**，再将密钥串流和**明文(plain text)**经过XOR运算后，产生**密文(cipher text)**。加密速度快，但相对容易被破解。

**电子密码本模式(Electronic Code Book(ECB) Mode)**是最早采用和最简单的加密模式，它将加密的数据分成若干组，每组的大小跟加密密钥长度相同，然后每组都用相同的密钥进行加密。比如DES算法，采用一个64位的密钥，明文分成每组64位的数据，最后一组补齐64位，然后每组数据都采用DES算法的64位密钥进行加密。

同样的明文块会被ECB加密成相同的密文块，因此它不能很好地隐藏数据模式。

**密码块链接模式(Cipher Block Chaining(CBC) Mode)**，首先也是将明文分成固定长度(64位)的块($P_0$、$P_1$，...)，然后将前面一个加密块输出的密文与当前要加密的明文块进行XOR操作计算，将计算结果再用密钥进行加密得到当前块的密文。第一明文块加密的时候，因为前面没有加密的密文，所以需要一个初始化向量(IV)。

跟ECB模式不一样的是，CBC模式通过链接关系使得密文跟明文不再一一对应，破解起来更困难，而且可以抵抗只要简单调换密文块就可以达到目的的攻击。缺点是不能实时解密，每一个密文块必须等到8个字节收齐后才能开始解密，不太适合实时性要求比较高的场合。

**密文反馈模式(Cipher Feedback(CFB) Mode)**，为了克服必须等到收齐8个字节才能进行解密的缺点，采用了一个64位(8个字节)的移位寄存器来获得密文。例如，当前源文字节是$P_{10}$，$C_2$、$C_3$、...、$C_9$是移位寄存器数据，加密时从移位寄存器取$C_2$~$C_9$用密钥施行加密运算，取加密数据最左边的一个字节跟输入的明文$P_{10}$进行XOR操作，得到的值作为输入密文$C_{10}$，同时将$C_{10}$送入到移位寄存器中。

**输出反馈模式(Output Feedback(OFB) Mode)**跟CFB的不同在于移位寄存器的数据来源。移位寄存器的数据来源于与明文进行XOR操作之前的数据。

**数据加密标准(Data Encryption Standard, DES)**是一种使用密钥加密的块密码，基于56位密钥的对称算法。DES现在已经不被视为一种安全的加密算法，主要原因是它使用的56位密钥过短。可以使用DES的派生算法3DES(EDE模式)来进行加密，但是也存在理论上的攻击方法。

DES算法的基本过程是换位和置换。

DES的信息空间由{0, 1}组成的字符串构成，原始明文消息和经过DES加密的密文信息是8个字节(64位)的分组，密钥也是64位。原始明文消息按PKCS#5规范进行字节填充：最后分组不够8个字节时，在末尾以字节填满，填入字节取值相同，都是填充的字节数目；刚好分组完全时，在末尾填充8个字节，字节取值都是08。

DES加密过程：$C=E_k(M)=IP^{-1} \cdot W \cdot T_{16} \cdot T_{15} \cdot ... \cdot T_{1} \cdot IP(M)$。

DES解密过程：$M=D_k(C)=IP^{-1} \cdot W \cdot T_{1} \cdot T_{2} \cdot ... \cdot T_{16} \cdot IP(C)$。

